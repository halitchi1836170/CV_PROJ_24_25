---------------------------------------SETTING UP - ATTENTION---------------------------------------
Experiment configuration:
Logs folder: ./logs/ATTENTION
Models folder: ./models/ATTENTION
Plots folder: ./plots/ATTENTION
Flag Use attention: True
Flag Remove sky: False
------------------------------------------------END------------------------------------------------

--------------------------------PARAMETERS OF : MODEL CONFIGURATION--------------------------------
name = MODEL CONFIGURATION
epochs = 10
learning_rate = 1e-05
batch_size = 8
loss_weight = 5.0
train_grd_FOV = 360
test_grd_FOV = 0
dropout_ratio = 0.2
no_layer_vgg_non_trainable = 9
vgg_default_weights = VGG16_Weights.IMAGENET1K_FEATURES
train_grd_noise = 360
log_frequency = 10
seed = 17
------------------------------------------------END------------------------------------------------

------------------------------------------LOADING DATASET------------------------------------------
Loading ./Data/CVUSA_subset/train-19zl.csv ...
Loaded, train_data size = 6647
Loading ./Data/CVUSA_subset/val-19zl.csv ...
Loaded, test_data size = 2215
------------------------------------------------END------------------------------------------------

-------------------------------------INSTANTIATION OF THE MODEL-------------------------------------
Creation of the model...
Model created, summary: 
Model: GroundToAerialMatchingModel
Total parameters: 48,144,800
Trainable parameters: 47,364,320
Model size: 183.66 MB
------------------------------------------------END------------------------------------------------

------------------------------------DEFINITION OF THE INPUT DATA------------------------------------
Ground (zero) input matrix dimension: torch.Size([2, 128, 512, 3])
Polar satellite (zero) input matrix dimension: torch.Size([2, 128, 512, 3])
Segmentation (zero) input matrix dimension: torch.Size([2, 128, 512, 3])
------------------------------------------------END------------------------------------------------

-------------------------------------------FIRST FEATURES-------------------------------------------
Calculating (forward pass) first features (zeros as input) ...
Ground features (zero input) matrix dimension: torch.Size([2, 4, 64, 16])
Polar satellite features (zero input) matrix dimension: torch.Size([2, 4, 64, 8])
Segmentation features (zero input) matrix dimension: torch.Size([2, 4, 64, 8])
Concatenated Satellite and Segmentation features (zero input) matrix dimension: torch.Size([2, 4, 64, 16])
------------------------------------------------END------------------------------------------------

----------------------------------------CORRELATION MATRICES----------------------------------------
Calculating correlation matrices...
Global satellite matrix dimensions: (2215, 4, 64, 16)
Global ground matrix dimensions: (2215, 4, 64, 16)
Orientation matrix dimensions: (2215,)
------------------------------------------------END------------------------------------------------

-----------------------------------------STARTING TRAINING-----------------------------------------
Using device: cuda
Epoch 1/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 1.888343, TOTAL LOSS: 76.584113
ITERATION: 20, mini-Batch 4 LOSS VALUE: 1.429152, TOTAL LOSS: 147.379259
ITERATION: 30, mini-Batch 4 LOSS VALUE: 1.248303, TOTAL LOSS: 195.511653
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.726985, TOTAL LOSS: 227.117646
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.575990, TOTAL LOSS: 256.168382
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.660878, TOTAL LOSS: 283.636374
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.734570, TOTAL LOSS: 309.648607
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.732204, TOTAL LOSS: 334.886550
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.766433, TOTAL LOSS: 360.237783
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.622823, TOTAL LOSS: 385.866044
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.621150, TOTAL LOSS: 411.070563
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.716477, TOTAL LOSS: 436.787411
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.577285, TOTAL LOSS: 460.919741
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.470194, TOTAL LOSS: 484.847096
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.527289, TOTAL LOSS: 508.299445
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.774903, TOTAL LOSS: 531.872969
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.606337, TOTAL LOSS: 555.664715
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.545845, TOTAL LOSS: 578.988327
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.612485, TOTAL LOSS: 602.164115
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.599359, TOTAL LOSS: 625.051849
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.561008, TOTAL LOSS: 642.185714
Epoch 2/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.525942, TOTAL LOSS: 22.349018
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.403640, TOTAL LOSS: 43.275889
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.427612, TOTAL LOSS: 65.238150
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.567044, TOTAL LOSS: 86.292491
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.485394, TOTAL LOSS: 106.609270
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.371713, TOTAL LOSS: 126.838369
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.659005, TOTAL LOSS: 146.644918
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.738963, TOTAL LOSS: 166.287346
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.438077, TOTAL LOSS: 186.815379
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.389843, TOTAL LOSS: 206.315344
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.578850, TOTAL LOSS: 226.668516
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.491033, TOTAL LOSS: 244.743403
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.423570, TOTAL LOSS: 264.052140
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.472635, TOTAL LOSS: 283.497309
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.587463, TOTAL LOSS: 302.443029
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.712965, TOTAL LOSS: 320.615891
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.459702, TOTAL LOSS: 339.886240
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.481264, TOTAL LOSS: 357.649218
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.225234, TOTAL LOSS: 377.065264
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.348674, TOTAL LOSS: 395.535477
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.546180, TOTAL LOSS: 410.993734
Epoch 3/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.462804, TOTAL LOSS: 18.203953
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.531045, TOTAL LOSS: 37.960743
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.431414, TOTAL LOSS: 55.399790
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.617071, TOTAL LOSS: 73.824717
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.290478, TOTAL LOSS: 90.880587
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.383036, TOTAL LOSS: 108.034867
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.405650, TOTAL LOSS: 125.772134
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.643979, TOTAL LOSS: 142.219230
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.481339, TOTAL LOSS: 159.930425
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.421257, TOTAL LOSS: 177.696868
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.632895, TOTAL LOSS: 194.219744
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.315032, TOTAL LOSS: 211.710787
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.429163, TOTAL LOSS: 229.345114
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.449681, TOTAL LOSS: 244.740905
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.447102, TOTAL LOSS: 260.299384
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.585111, TOTAL LOSS: 276.393114
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.324564, TOTAL LOSS: 293.236820
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.377023, TOTAL LOSS: 309.372604
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.299131, TOTAL LOSS: 326.255143
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.427252, TOTAL LOSS: 340.580603
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.486848, TOTAL LOSS: 352.296743
Epoch 4/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.329813, TOTAL LOSS: 16.839026
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.729694, TOTAL LOSS: 31.882308
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.317693, TOTAL LOSS: 47.667825
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.270287, TOTAL LOSS: 62.316450
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.359116, TOTAL LOSS: 78.442371
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.319949, TOTAL LOSS: 94.173036
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.410018, TOTAL LOSS: 109.313142
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.360587, TOTAL LOSS: 125.702910
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.287260, TOTAL LOSS: 140.758627
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.388431, TOTAL LOSS: 155.570421
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.335279, TOTAL LOSS: 169.524265
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.308049, TOTAL LOSS: 183.502687
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.581646, TOTAL LOSS: 198.663612
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.494420, TOTAL LOSS: 213.747731
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.326396, TOTAL LOSS: 227.453839
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.424706, TOTAL LOSS: 242.362110
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.489621, TOTAL LOSS: 257.212453
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.363263, TOTAL LOSS: 272.473276
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.210338, TOTAL LOSS: 287.160337
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.266196, TOTAL LOSS: 301.144964
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.189029, TOTAL LOSS: 311.773944
Epoch 5/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.405029, TOTAL LOSS: 14.230193
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.332019, TOTAL LOSS: 28.304210
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.340010, TOTAL LOSS: 41.643893
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.449681, TOTAL LOSS: 55.108857
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.359548, TOTAL LOSS: 68.826360
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.347311, TOTAL LOSS: 83.280318
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.222686, TOTAL LOSS: 97.587274
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.506466, TOTAL LOSS: 112.217991
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.206033, TOTAL LOSS: 124.628103
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.204339, TOTAL LOSS: 139.040516
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.518520, TOTAL LOSS: 151.294325
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.401485, TOTAL LOSS: 165.438277
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.373159, TOTAL LOSS: 178.608103
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.249782, TOTAL LOSS: 191.974464
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.409983, TOTAL LOSS: 203.480008
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.311648, TOTAL LOSS: 216.925449
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.275076, TOTAL LOSS: 231.590923
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.147337, TOTAL LOSS: 244.312192
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.464158, TOTAL LOSS: 256.828478
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.355755, TOTAL LOSS: 270.694612
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.319767, TOTAL LOSS: 281.345219
Epoch 6/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.347743, TOTAL LOSS: 12.492082
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.435158, TOTAL LOSS: 24.510237
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.229602, TOTAL LOSS: 37.875048
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.690074, TOTAL LOSS: 51.201793
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.138820, TOTAL LOSS: 62.931772
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.290922, TOTAL LOSS: 74.718585
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.733394, TOTAL LOSS: 87.068357
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.344719, TOTAL LOSS: 99.134197
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.311698, TOTAL LOSS: 113.115659
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.372242, TOTAL LOSS: 125.525250
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.474846, TOTAL LOSS: 138.138551
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.392217, TOTAL LOSS: 149.947926
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.526013, TOTAL LOSS: 163.957762
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.211760, TOTAL LOSS: 176.241508
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.273424, TOTAL LOSS: 189.041220
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.424839, TOTAL LOSS: 201.388000
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.142858, TOTAL LOSS: 213.958866
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.449031, TOTAL LOSS: 228.290588
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.635757, TOTAL LOSS: 240.180958
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.291642, TOTAL LOSS: 252.765662
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.439144, TOTAL LOSS: 263.045176
Epoch 7/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.462231, TOTAL LOSS: 11.955742
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.235168, TOTAL LOSS: 25.595197
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.238171, TOTAL LOSS: 37.502323
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.585393, TOTAL LOSS: 50.204336
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.095682, TOTAL LOSS: 62.495009
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.197992, TOTAL LOSS: 74.537976
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.466087, TOTAL LOSS: 86.035817
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.539011, TOTAL LOSS: 98.659845
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.226663, TOTAL LOSS: 109.486538
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.359418, TOTAL LOSS: 121.630806
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.360167, TOTAL LOSS: 133.887180
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.391750, TOTAL LOSS: 146.174780
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.218316, TOTAL LOSS: 157.662713
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.116069, TOTAL LOSS: 169.698253
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.494325, TOTAL LOSS: 181.915137
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.277016, TOTAL LOSS: 193.770591
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.345065, TOTAL LOSS: 205.095828
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.331438, TOTAL LOSS: 216.698679
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.216259, TOTAL LOSS: 228.085119
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.196537, TOTAL LOSS: 238.619769
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.256229, TOTAL LOSS: 248.775687
Epoch 8/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.488052, TOTAL LOSS: 11.212488
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.438942, TOTAL LOSS: 22.339843
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.113312, TOTAL LOSS: 33.519269
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.298697, TOTAL LOSS: 45.435539
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.297462, TOTAL LOSS: 55.950199
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.275410, TOTAL LOSS: 67.750770
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.362909, TOTAL LOSS: 80.429003
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.189162, TOTAL LOSS: 92.885284
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.121716, TOTAL LOSS: 103.119822
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.313084, TOTAL LOSS: 114.289219
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.320797, TOTAL LOSS: 126.110346
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.158871, TOTAL LOSS: 137.240305
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.152139, TOTAL LOSS: 148.506648
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.586198, TOTAL LOSS: 159.902766
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.109394, TOTAL LOSS: 171.588823
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.478308, TOTAL LOSS: 184.279878
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.129967, TOTAL LOSS: 193.887486
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.195448, TOTAL LOSS: 205.600953
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.422611, TOTAL LOSS: 216.187430
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.195262, TOTAL LOSS: 228.567830
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.178482, TOTAL LOSS: 237.331542
Epoch 9/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.260256, TOTAL LOSS: 10.858756
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.103938, TOTAL LOSS: 21.049378
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.450181, TOTAL LOSS: 32.932581
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.436308, TOTAL LOSS: 43.719119
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.395472, TOTAL LOSS: 53.567031
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.334076, TOTAL LOSS: 64.763128
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.061338, TOTAL LOSS: 76.872217
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.199818, TOTAL LOSS: 86.905971
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.181957, TOTAL LOSS: 96.841795
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.223879, TOTAL LOSS: 108.402330
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.211958, TOTAL LOSS: 118.756367
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.344785, TOTAL LOSS: 129.225110
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.205841, TOTAL LOSS: 139.296920
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.087166, TOTAL LOSS: 149.993886
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.413503, TOTAL LOSS: 161.009668
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.388564, TOTAL LOSS: 172.542408
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.320829, TOTAL LOSS: 183.328715
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.162732, TOTAL LOSS: 193.884064
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.229478, TOTAL LOSS: 204.640923
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.218417, TOTAL LOSS: 216.774921
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.223230, TOTAL LOSS: 223.776998
Epoch 10/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.315913, TOTAL LOSS: 10.407767
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.233265, TOTAL LOSS: 21.430724
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.307105, TOTAL LOSS: 30.676097
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.289661, TOTAL LOSS: 40.220511
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.178408, TOTAL LOSS: 50.570672
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.608810, TOTAL LOSS: 61.359119
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.046606, TOTAL LOSS: 71.539743
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.039782, TOTAL LOSS: 81.705014
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.182484, TOTAL LOSS: 92.405919
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.215524, TOTAL LOSS: 103.498110
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.399278, TOTAL LOSS: 114.055994
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.181858, TOTAL LOSS: 125.853835
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.231444, TOTAL LOSS: 135.093007
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.226200, TOTAL LOSS: 144.759977
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.218316, TOTAL LOSS: 154.951971
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.356943, TOTAL LOSS: 164.724137
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.370697, TOTAL LOSS: 175.673967
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.517503, TOTAL LOSS: 186.094532
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.326287, TOTAL LOSS: 196.379880
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.320339, TOTAL LOSS: 207.645876
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.239677, TOTAL LOSS: 215.262697
ATTENTION - Mini batch losses plot salvato in: ./plots/ATTENTION/iterative_loss.png
-----------------------------------TRAINING COMPLETED - ATTENTION-----------------------------------
-----------------------------------Experiment ATTENTION completed-----------------------------------

-----------------------------------Running experiment: SKYREMOVAL-----------------------------------
--------------------------------------SETTING UP - SKYREMOVAL--------------------------------------
Experiment configuration:
Logs folder: ./logs/SKYREMOVAL
Models folder: ./models/SKYREMOVAL
Plots folder: ./plots/SKYREMOVAL
Flag Use attention: False
Flag Remove sky: True
------------------------------------------------END------------------------------------------------

--------------------------------PARAMETERS OF : MODEL CONFIGURATION--------------------------------
name = MODEL CONFIGURATION
epochs = 10
learning_rate = 1e-05
batch_size = 8
loss_weight = 5.0
train_grd_FOV = 360
test_grd_FOV = 0
dropout_ratio = 0.2
no_layer_vgg_non_trainable = 9
vgg_default_weights = VGG16_Weights.IMAGENET1K_FEATURES
train_grd_noise = 360
log_frequency = 10
seed = 17
------------------------------------------------END------------------------------------------------

------------------------------------------LOADING DATASET------------------------------------------
Loading ./Data/CVUSA_subset/train-19zl.csv ...
Loaded, train_data size = 6647
Loading ./Data/CVUSA_subset/val-19zl.csv ...
Loaded, test_data size = 2215
------------------------------------------------END------------------------------------------------

-------------------------------------INSTANTIATION OF THE MODEL-------------------------------------
Creation of the model...
Model created, summary: 
Model: GroundToAerialMatchingModel
Total parameters: 48,144,800
Trainable parameters: 47,364,320
Model size: 183.66 MB
------------------------------------------------END------------------------------------------------

------------------------------------DEFINITION OF THE INPUT DATA------------------------------------
Ground (zero) input matrix dimension: torch.Size([2, 128, 512, 3])
Polar satellite (zero) input matrix dimension: torch.Size([2, 128, 512, 3])
Segmentation (zero) input matrix dimension: torch.Size([2, 128, 512, 3])
------------------------------------------------END------------------------------------------------

-------------------------------------------FIRST FEATURES-------------------------------------------
Calculating (forward pass) first features (zeros as input) ...
Ground features (zero input) matrix dimension: torch.Size([2, 4, 64, 16])
Polar satellite features (zero input) matrix dimension: torch.Size([2, 4, 64, 8])
Segmentation features (zero input) matrix dimension: torch.Size([2, 4, 64, 8])
Concatenated Satellite and Segmentation features (zero input) matrix dimension: torch.Size([2, 4, 64, 16])
------------------------------------------------END------------------------------------------------

----------------------------------------CORRELATION MATRICES----------------------------------------
Calculating correlation matrices...
Global satellite matrix dimensions: (2215, 4, 64, 16)
Global ground matrix dimensions: (2215, 4, 64, 16)
Orientation matrix dimensions: (2215,)
------------------------------------------------END------------------------------------------------

-----------------------------------------STARTING TRAINING-----------------------------------------
Using device: cuda
Epoch 1/10
ITERATION: 10, mini-Batch 4 LOSS VALUE: 2.575873, TOTAL LOSS: 87.940068
ITERATION: 20, mini-Batch 4 LOSS VALUE: 2.581671, TOTAL LOSS: 173.283619
ITERATION: 30, mini-Batch 4 LOSS VALUE: 2.239822, TOTAL LOSS: 256.876186
ITERATION: 40, mini-Batch 4 LOSS VALUE: 1.548605, TOTAL LOSS: 336.426804
ITERATION: 50, mini-Batch 4 LOSS VALUE: 1.378999, TOTAL LOSS: 401.614252
ITERATION: 60, mini-Batch 4 LOSS VALUE: 1.639874, TOTAL LOSS: 450.024967
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.861704, TOTAL LOSS: 492.431423
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.792424, TOTAL LOSS: 528.211955
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.852292, TOTAL LOSS: 563.053949
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.903096, TOTAL LOSS: 596.521452
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.780684, TOTAL LOSS: 628.235119
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.760293, TOTAL LOSS: 660.512136
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.776517, TOTAL LOSS: 691.717214
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.601038, TOTAL LOSS: 720.759438
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.831929, TOTAL LOSS: 751.305834
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.948835, TOTAL LOSS: 781.143073
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.672544, TOTAL LOSS: 810.367328
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.787339, TOTAL LOSS: 840.336933
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.754175, TOTAL LOSS: 868.033478
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.438422, TOTAL LOSS: 896.124307
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.563210, TOTAL LOSS: 917.427284
Epoch 2/10
Saving ground image without sky for debug...
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.817444, TOTAL LOSS: 26.883107
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.574238, TOTAL LOSS: 53.776616
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.499700, TOTAL LOSS: 79.803653
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.512670, TOTAL LOSS: 106.396652
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.677367, TOTAL LOSS: 132.193514
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.751703, TOTAL LOSS: 158.676480
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.606418, TOTAL LOSS: 184.847570
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.664317, TOTAL LOSS: 210.469504
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.694892, TOTAL LOSS: 235.749662
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.464241, TOTAL LOSS: 260.344752
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.599559, TOTAL LOSS: 285.439912
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.563022, TOTAL LOSS: 309.935495
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.738289, TOTAL LOSS: 334.632040
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.507850, TOTAL LOSS: 358.204262
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.535977, TOTAL LOSS: 384.219509
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.498022, TOTAL LOSS: 408.667486
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.498645, TOTAL LOSS: 433.284452
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.545806, TOTAL LOSS: 457.639553
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.899482, TOTAL LOSS: 482.219418
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.613362, TOTAL LOSS: 507.406516
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.666536, TOTAL LOSS: 525.810842
Epoch 3/10
Saving ground image without sky for debug...
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.943926, TOTAL LOSS: 23.872067
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.514766, TOTAL LOSS: 47.942517
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.605201, TOTAL LOSS: 71.459505
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.693741, TOTAL LOSS: 94.732095
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.550977, TOTAL LOSS: 118.673627
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.655871, TOTAL LOSS: 142.168756
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.532087, TOTAL LOSS: 165.342501
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.570366, TOTAL LOSS: 188.876526
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.558034, TOTAL LOSS: 214.186920
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.739956, TOTAL LOSS: 238.027907
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.854806, TOTAL LOSS: 261.788407
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.624590, TOTAL LOSS: 285.199672
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.496009, TOTAL LOSS: 307.987436
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.507846, TOTAL LOSS: 331.391138
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.829960, TOTAL LOSS: 353.654698
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.659114, TOTAL LOSS: 377.470217
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.619764, TOTAL LOSS: 399.114487
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.395195, TOTAL LOSS: 420.884727
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.658728, TOTAL LOSS: 443.678978
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.434511, TOTAL LOSS: 465.695023
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.460292, TOTAL LOSS: 481.890138
Epoch 4/10
Saving ground image without sky for debug...
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.348666, TOTAL LOSS: 20.499628
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.625920, TOTAL LOSS: 41.891972
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.511306, TOTAL LOSS: 63.623986
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.410190, TOTAL LOSS: 85.553929
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.419444, TOTAL LOSS: 107.318810
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.590456, TOTAL LOSS: 129.199057
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.624981, TOTAL LOSS: 150.638555
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.521266, TOTAL LOSS: 171.719473
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.437543, TOTAL LOSS: 191.661168
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.549868, TOTAL LOSS: 213.018869
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.603642, TOTAL LOSS: 233.689903
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.478035, TOTAL LOSS: 254.687650
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.853704, TOTAL LOSS: 275.778206
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.539603, TOTAL LOSS: 297.733917
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.374432, TOTAL LOSS: 318.976519
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.616148, TOTAL LOSS: 341.495179
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.443869, TOTAL LOSS: 361.372148
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.350201, TOTAL LOSS: 381.327380
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.759538, TOTAL LOSS: 402.186305
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.473829, TOTAL LOSS: 422.693738
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.439807, TOTAL LOSS: 438.486897
Epoch 5/10
Saving ground image without sky for debug...
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.366039, TOTAL LOSS: 20.146463
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.709673, TOTAL LOSS: 38.853654
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.473403, TOTAL LOSS: 58.795667
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.449962, TOTAL LOSS: 77.616091
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.421450, TOTAL LOSS: 96.597022
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.475088, TOTAL LOSS: 116.340639
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.456839, TOTAL LOSS: 134.799012
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.678968, TOTAL LOSS: 155.182472
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.313485, TOTAL LOSS: 174.630484
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.454895, TOTAL LOSS: 192.540035
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.387667, TOTAL LOSS: 213.405052
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.427472, TOTAL LOSS: 231.972409
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.438693, TOTAL LOSS: 250.605146
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.467860, TOTAL LOSS: 270.762195
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.455234, TOTAL LOSS: 290.471176
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.299545, TOTAL LOSS: 309.711436
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.348796, TOTAL LOSS: 328.912306
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.733673, TOTAL LOSS: 348.815218
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.581776, TOTAL LOSS: 367.098160
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.699039, TOTAL LOSS: 386.735154
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.614748, TOTAL LOSS: 401.341819
Epoch 6/10
Saving ground image without sky for debug...
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.610310, TOTAL LOSS: 19.256071
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.420228, TOTAL LOSS: 37.256655
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.475706, TOTAL LOSS: 55.739310
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.502369, TOTAL LOSS: 73.943170
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.630147, TOTAL LOSS: 93.497817
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.361888, TOTAL LOSS: 111.913672
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.484756, TOTAL LOSS: 130.672906
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.547572, TOTAL LOSS: 149.117025
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.543259, TOTAL LOSS: 166.926980
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.510214, TOTAL LOSS: 184.459221
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.294250, TOTAL LOSS: 202.584568
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.682261, TOTAL LOSS: 220.507714
ITERATION: 130, mini-Batch 4 LOSS VALUE: 0.363958, TOTAL LOSS: 238.601143
ITERATION: 140, mini-Batch 4 LOSS VALUE: 0.318329, TOTAL LOSS: 256.457433
ITERATION: 150, mini-Batch 4 LOSS VALUE: 0.408847, TOTAL LOSS: 274.122734
ITERATION: 160, mini-Batch 4 LOSS VALUE: 0.340072, TOTAL LOSS: 291.271897
ITERATION: 170, mini-Batch 4 LOSS VALUE: 0.414262, TOTAL LOSS: 309.155384
ITERATION: 180, mini-Batch 4 LOSS VALUE: 0.507931, TOTAL LOSS: 327.629503
ITERATION: 190, mini-Batch 4 LOSS VALUE: 0.377537, TOTAL LOSS: 345.107160
ITERATION: 200, mini-Batch 4 LOSS VALUE: 0.456409, TOTAL LOSS: 363.528440
[BATCH] Partial batch: 7/8 - Skipped: 0
Satellite batch is None, breaking...
FINAL LOG - ITERATION: 208, mini-Batch 4 LOSS VALUE: 0.427293, TOTAL LOSS: 376.983018
Epoch 7/10
Saving ground image without sky for debug...
ITERATION: 10, mini-Batch 4 LOSS VALUE: 0.481072, TOTAL LOSS: 16.539608
ITERATION: 20, mini-Batch 4 LOSS VALUE: 0.361336, TOTAL LOSS: 33.161885
ITERATION: 30, mini-Batch 4 LOSS VALUE: 0.502177, TOTAL LOSS: 52.440849
ITERATION: 40, mini-Batch 4 LOSS VALUE: 0.589147, TOTAL LOSS: 69.688060
ITERATION: 50, mini-Batch 4 LOSS VALUE: 0.369297, TOTAL LOSS: 86.805365
ITERATION: 60, mini-Batch 4 LOSS VALUE: 0.352017, TOTAL LOSS: 103.589584
ITERATION: 70, mini-Batch 4 LOSS VALUE: 0.418114, TOTAL LOSS: 120.702772
ITERATION: 80, mini-Batch 4 LOSS VALUE: 0.353236, TOTAL LOSS: 137.677780
ITERATION: 90, mini-Batch 4 LOSS VALUE: 0.524376, TOTAL LOSS: 155.066685
ITERATION: 100, mini-Batch 4 LOSS VALUE: 0.377628, TOTAL LOSS: 172.644371
ITERATION: 110, mini-Batch 4 LOSS VALUE: 0.430380, TOTAL LOSS: 190.171217
ITERATION: 120, mini-Batch 4 LOSS VALUE: 0.450247, TOTAL LOSS: 206.398724
